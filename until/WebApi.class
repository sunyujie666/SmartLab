using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Management;

namespace SmartLab.until
{
    class WebApi
    {

    	public static void main(String []args)
        {
        	String str=HttpGet("http://t.weather.sojson.com/api/weather/city/101030100","");
            Console.WriteLine(str);
        }

		public static string HttpPost(string Url,string getDataStr)
		{
			HttpWebRequest request = (HttpWebRequest)HttpWebResponse.Create(Url+(postDataStr==""?"":"?")+postDataStr);
			request.Method="POST";
			request.Content-Type="application/x-www-form-urlencoded";

			request.ContentLength = Encoding.UTF8.GetByteCount(postDataStr);
			Stream myRequestStream = request.GetRequestStream();
			StreamWriter myStreamWriter = new StreamWriter(myRequestStream,Encoding.Getencoding("gb2312"));

			myStreamReader.Write(postDataStr);
			myStreamWriter.Close();

			//∑¢ÀÕ«Î«Û
			HttpWebResponse response =(HttpWebResponse)request.getResponse();

			Stream myResponseStream = response.GetResponseStream();
			StreamReader myStreamReader = new StreamReader(myResponseStream,Encoding.GetEncoding("utf-8"));
		    string retString = myStreamReader.ReadToEnd();
		    myStreamReader.close();
		    myResponseStream.close();
		    return retString;	
		}	


		public static string HttpGet(string Url, string postDataStr)
		{
			HttpWebRequest request = (HttpWebRequest)WebRequest.Create(Url + (postDataStr == "" ? "" : "?") + postDataStr);
			request.Method = "GET";
			request.ContentType = "text/html;charset=UTF-8";

			HttpWebResponse response = (HttpWebResponse)request.GetResponse();
			Stream myResponseStream = response.GetResponseStream();
			StreamReader myStreamReader = new StreamReader(myResponseStream, Encoding.GetEncoding("utf-8"));
			string retString = myStreamReader.ReadToEnd();
			myStreamReader.Close();
			myResponseStream.Close();  
			return retString;
		}
	}
}